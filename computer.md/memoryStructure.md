## 3.Memory Structure
### 1. 프로그램 실행 순서

![실행순서](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FcQRqku%2Fbtru0vJ6Ixx%2F9qCTW7ChXc80fGfQUrT4B0%2Fimg.png)

1. 자바로 개발된 프로그램을 실행하면 jvm은 os로부터 메모리를 할당받습니다.
2. 자바 컴파일러(javac)가 자바 소스코드를(.java) 지바 바이트코드(.class)로 컴파일합니다.
3. class loader를 통해 바이트 코드를 jvm runtime data area로 로딩합니다.
4. runtime data area에 로딩된 바이트 코드(.class)들은 execution engine을 통해 해석합니다.
5. 해석된 바이트 코드는 runtime data area의 각 영역에 배치되어 수행하며 이 과정에서 execution engine에 의해 gc의 작동과 스레드 동기화가 이루어집니다.

- 쓰레드 동기화 : 한 쓰레드가 진행 중인 작업을 다른 스레드가 간섭하지 못하도록 막는 것
### 2. 코드(Code) 영역
![메모리 이미지](https://i.imgur.com/FdJ8Xbd.png)

1. 우리가 작성한 소스코드가 들어가는 부분
2. 즉 실행할 프로그램의 코드가 저장되는 영역으로 텍스트(code)영역 이라고도 부른다.
3. 코드영역은 실행 파일을 구성하는 명령어들이 올라가는 메모리 영역으로 함수, 제어문, 상수 등이 여기에 지정된다.

### 3. 데이터(Data) 영역
1. 전역변수와 static 변수가 할당되는 영역
2. 프로그램의 시작과 동시에 할당되고, 프로그램이 종료되어야 메모리가 소멸되는 영역

### 4. 스택(Stack) 영역
1. 프로그램이 자동으로 사용하는 임시 메모리 영역이다.
2. 함수 호출 시 생성되는 지역 변수와 매개 변수가 저장되는 영역이고, 함수 호출이 완료되면 사라집니다.

### 5. 힙(Heap)영역
1. 프로그래머가 할당/해제하는 메모리 공간이다.
2. Java에서는 가비지 컬렉터가 자동으로 해제합니다.
3. 이 공간에 메모리 할당하는 것을 동적 할당(Dynamic Memory Allocation)이라고도 부른다.
4. 예를 들어 클래스, 클로저가 이 부분에 해당 된다.
5. 런타임 시에 크기가 결정된다.

![HEAP](https://i.imgur.com/GImVa8L.png)

6. 위의 HEAP과 STACK영역은 사실 같은 공간을 공유한다.
7. HEAP이 메모리 위쪽 주소부터 할당되면 STACK은 아래쪽부터 할당되는 식이다.
8. 그래서 각 영역이 상대 공간을 침범하는 일이 발생할 수 있는데 이를 HEAP OVERFLOW,STSCK OVERFLOW라고 칭합니다.
9. Stack 영역이 크면  클수록 Heap영역이 작아지고, Heap 영역이 클수록 Stack 영역이 작아집니다.

### 6. Java Primitive Type VS Reference Type
1. Primitive Type(기본형 타입)
    - 실제 값을 저장하고 메모리는 스택 메모리에 저장된다.

2. Reference Type(참조형 타입)
    - 값이 저장되어 있는 곳의 주소 값을 저장하고, 메모리는 힙 메모리에 저장된다.

### 7. Static area
1. JAVA 파일은 크게 필드, 생성자, 메소드로 구성된다. 
2. 그 중 필드 부분에서 선언된 변수(전역 변수)와 정적멤버변수(static이 붙은 자료형) Static 영역에 데이터를 저장한다.
3. Static 영역의 데이터는 프로그램 시작 부터 종료가 될 때 까지 메모리에 남아있게 된다.
4. 전역변수가 프로그램이 종료될때까지 어디서든 사용이 가능한 이유이기도 하다.
5. 따라서 전역변수를 무분별하게 많이 사용하다 보면 메모리가 부족할 우려가 있어 필요한 변수만 사용할 필요가 있다.

### 8. 클래스 로더 (Class Loader)
1. 자바는 동적으로 클래스를 읽어오므로, 프로그램이 실행 중인 런타임에서야 모든 코드가 자바 가상 머신과 연결됩니다. 이렇게 동적으로 클래스를 로딩해주는 역할을 하는 것이 클래스 로더이다.
2. 클래스 로더는 자바 바이트 코드를 묶어서 jvm이 운영체제로 부터 할당받은 메모리 영역인 Runtime Data Area로 적재합니다.